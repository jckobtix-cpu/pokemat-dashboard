<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pok√©mon Automat ‚Äì Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0a0a0c;--surface:#111114;--surface2:#18181d;--surface3:#1f1f26;
  --border:rgba(255,255,255,0.06);--border2:rgba(255,255,255,0.1);
  --text:#e8e8ec;--muted:#5a5a6a;--muted2:#8888a0;
  --accent:#4f8ef7;--accent2:#22c55e;--warn:#f59e0b;--danger:#ef4444;--purple:#a78bfa;--pink:#f472b6;--cyan:#06b6d4;--lime:#84cc16;
  --r:12px;--rl:16px;
}
html{font-size:15px}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;min-height:100vh}
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-thumb{background:var(--surface3);border-radius:99px}
.layout{display:flex;min-height:100vh}

/* SIDEBAR */
.sidebar{width:228px;flex-shrink:0;background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;padding:1.25rem .875rem;position:sticky;top:0;height:100vh;overflow-y:auto}
.sidebar-logo{display:flex;align-items:center;gap:10px;padding:.25rem .5rem 1.25rem;border-bottom:1px solid var(--border);margin-bottom:1.25rem}
.logo-icon{width:36px;height:36px;border-radius:9px;background:linear-gradient(135deg,#4f8ef7,#7c3aed);display:flex;align-items:center;justify-content:center;font-size:1.15rem;flex-shrink:0}
.logo-text{font-size:.82rem;font-weight:700;line-height:1.2}
.logo-text span{display:block;font-size:.66rem;font-weight:400;color:var(--muted2);margin-top:1px}
.nav-sec{margin-bottom:1.1rem}
.nav-lbl{font-size:.62rem;font-weight:700;text-transform:uppercase;letter-spacing:.12em;color:var(--muted);padding:0 .6rem;margin-bottom:.3rem}
.nav-item{display:flex;align-items:center;gap:8px;padding:.48rem .6rem;border-radius:8px;font-size:.82rem;font-weight:500;color:var(--muted2);cursor:pointer;transition:all .15s;margin-bottom:1px;text-decoration:none}
.nav-item:hover{background:var(--surface2);color:var(--text)}
.nav-item.active{background:rgba(79,142,247,.1);color:var(--accent)}
.nav-ico{font-size:.95rem;width:17px;text-align:center;flex-shrink:0}
.sidebar-foot{margin-top:auto;padding-top:.875rem;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:6px}
.api-st{display:flex;align-items:center;gap:7px;padding:.5rem .6rem;background:var(--surface2);border-radius:8px;font-size:.72rem;color:var(--muted2)}
.api-dot{width:6px;height:6px;border-radius:50%;background:var(--accent2);box-shadow:0 0 5px var(--accent2);animation:blink 2s ease-in-out infinite;flex-shrink:0}
.api-dot.red{background:var(--danger);box-shadow:0 0 5px var(--danger);animation:none}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.35}}
.btn-logout{display:flex;align-items:center;gap:8px;padding:.48rem .6rem;border-radius:8px;font-size:.82rem;font-weight:500;color:var(--muted2);cursor:pointer;border:none;background:none;font-family:inherit;width:100%;transition:all .15s}
.btn-logout:hover{background:rgba(239,68,68,.08);color:var(--danger)}

/* MAIN */
.main{flex:1;min-width:0;display:flex;flex-direction:column}
.topbar{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.75rem;border-bottom:1px solid var(--border);background:var(--surface);position:sticky;top:0;z-index:50}
.topbar h1{font-size:1rem;font-weight:600;letter-spacing:-.02em}
.topbar p{font-size:.72rem;color:var(--muted2);margin-top:1px}
.tbr{display:flex;align-items:center;gap:.625rem}
.ptabs{display:flex;background:var(--surface2);border-radius:8px;padding:3px;gap:2px}
.ptab{padding:5px 13px;border-radius:6px;font-size:.75rem;font-weight:500;color:var(--muted2);cursor:pointer;transition:all .15s;border:none;background:transparent;font-family:inherit}
.ptab:hover{color:var(--text)}
.ptab.active{background:var(--surface);color:var(--text);box-shadow:0 1px 3px rgba(0,0,0,.4)}
.btn-ref{display:flex;align-items:center;gap:5px;padding:6px 13px;background:var(--surface2);border:1px solid var(--border2);border-radius:8px;color:var(--text);font-size:.75rem;font-weight:500;cursor:pointer;transition:all .15s;font-family:inherit}
.btn-ref:hover{background:var(--accent);border-color:var(--accent)}
.content{padding:1.5rem 1.75rem;flex:1}

/* LOADING */
.loading-overlay{position:fixed;inset:0;background:rgba(10,10,12,.85);display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:200;gap:1rem;font-size:.88rem;color:var(--muted2);backdrop-filter:blur(4px)}
.spinner{width:34px;height:34px;border:2.5px solid var(--surface3);border-top-color:var(--accent);border-radius:50%;animation:spin .75s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* SECTION */
.sec-hdr{display:flex;align-items:center;gap:10px;margin:0 0 1rem}
.sec-title{font-size:.72rem;font-weight:700;text-transform:uppercase;letter-spacing:.11em;color:var(--muted2);white-space:nowrap}
.sec-line{flex:1;height:1px;background:var(--border)}

/* STAT CARDS */
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:.875rem;margin-bottom:.875rem}
.sc{background:var(--surface);border:1px solid var(--border);border-radius:var(--rl);padding:1.1rem 1.25rem;position:relative;overflow:hidden;transition:border-color .2s,transform .2s;cursor:default}
.sc:hover{border-color:var(--border2);transform:translateY(-2px)}
.sc::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px}
.sc-blue::after{background:linear-gradient(90deg,var(--accent) 50%,transparent)}
.sc-green::after{background:linear-gradient(90deg,var(--accent2) 60%,transparent)}
.sc-warn::after{background:linear-gradient(90deg,var(--warn) 45%,transparent)}
.sc-red::after{background:linear-gradient(90deg,var(--danger) 35%,transparent)}
.sc-purple::after{background:linear-gradient(90deg,var(--purple) 40%,transparent)}
.sc-pink::after{background:linear-gradient(90deg,var(--pink) 35%,transparent)}
.sc-cyan::after{background:linear-gradient(90deg,var(--cyan) 45%,transparent)}
.sc-lime::after{background:linear-gradient(90deg,var(--lime) 50%,transparent)}
.st{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:.7rem}
.sl{font-size:.68rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--muted2)}
.badge{font-size:.62rem;font-weight:700;padding:3px 7px;border-radius:99px}
.bu{background:rgba(34,197,94,.12);color:var(--accent2)}
.bn{background:rgba(107,107,122,.12);color:var(--muted2)}
.bs{background:rgba(245,158,11,.12);color:var(--warn)}
.bp{background:rgba(167,139,250,.12);color:var(--purple)}
.sv{font-size:1.75rem;font-weight:700;letter-spacing:-.03em;line-height:1;margin-bottom:.3rem}
.ss{font-size:.7rem;color:var(--muted2);line-height:1.4}
.ss strong{color:var(--text);font-weight:600}

/* CARD */
.card{background:var(--surface);border:1px solid var(--border);border-radius:var(--rl);padding:1.25rem 1.375rem}
.ch{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:1rem}
.ct{font-size:.875rem;font-weight:600;letter-spacing:-.01em}
.cs{font-size:.7rem;color:var(--muted2);margin-top:2px}
.gm{display:grid;grid-template-columns:1fr 310px;gap:.875rem}

/* TX */
.tx-row{display:flex;align-items:center;gap:9px;padding:.55rem 0;border-bottom:1px solid var(--border);font-size:.78rem}
.tx-row:last-child{border-bottom:none}
.tx-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.dg{background:var(--accent2)}.db{background:var(--accent)}.dw{background:var(--warn)}
.tt{font-family:'DM Mono',monospace;font-size:.68rem;color:var(--muted2);width:40px;flex-shrink:0}
.tp{flex:1;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.tm{color:var(--muted2);font-size:.68rem;width:68px;flex-shrink:0}
.ta{font-family:'DM Mono',monospace;font-weight:600;color:var(--accent2);font-size:.78rem}
.empty{color:var(--muted2);font-size:.78rem;padding:.75rem 0}

/* DEMO BADGE */
.demo-badge{display:inline-flex;align-items:center;gap:5px;background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.2);border-radius:6px;padding:3px 8px;font-size:.68rem;font-weight:600;color:var(--warn);margin-bottom:1rem}

@media(max-width:1200px){.stats-row{grid-template-columns:repeat(2,1fr)}.gm{grid-template-columns:1fr}}
@media(max-width:900px){.sidebar{display:none}.content{padding:1rem}.topbar{padding:.875rem 1rem}}
</style>
</head>
<body>

<div class="loading-overlay" id="loading">
  <div class="spinner"></div>
  <span>Naƒç√≠t√°m data...</span>
</div>

<div class="layout">

<nav class="sidebar">
  <div class="sidebar-logo">
    <div class="logo-icon">üéÆ</div>
    <div class="logo-text">Pok√©mon Automat <span>Nayax ¬∑ Live Dashboard</span></div>
  </div>
  <div class="nav-sec">
    <div class="nav-lbl">Navigace</div>
    <a href="dashboard.html" class="nav-item active"><span class="nav-ico">üìä</span> Dashboard</a>
    <a href="grafy.html" class="nav-item"><span class="nav-ico">üìà</span> Grafy</a>
    <a href="produkty.html" class="nav-item"><span class="nav-ico">üì¶</span> Produkty</a>
  </div>
  <div class="nav-sec">
    <div class="nav-lbl">Automat</div>
    <div class="nav-item"><span class="nav-ico">üñ•Ô∏è</span> Stav automatu</div>
    <div class="nav-item"><span class="nav-ico">‚öôÔ∏è</span> Nastaven√≠</div>
  </div>
  <div class="sidebar-foot">
    <div class="api-st"><div class="api-dot" id="apiDot"></div><span id="apiStatus">P≈ôipojuji...</span></div>
    <button class="btn-logout" onclick="logout()"><span class="nav-ico">üö™</span> Odhl√°sit se</button>
  </div>
</nav>

<div class="main">
  <div class="topbar">
    <div><h1>Sales Dashboard</h1><p>Aktualizov√°no: <span id="lastUpdate">‚Äì</span> ¬∑ Automat 235556676</p></div>
    <div class="tbr">
      <div class="ptabs">
        <button class="ptab" onclick="setPeriod(this,7)">7 dn√≠</button>
        <button class="ptab active" onclick="setPeriod(this,30)">30 dn√≠</button>
        <button class="ptab" onclick="setPeriod(this,90)">90 dn√≠</button>
      </div>
      <button class="btn-ref" onclick="loadData()">‚Üª Obnovit</button>
    </div>
  </div>

  <div class="content">

    <div id="demoBadge" style="display:none" class="demo-badge">‚ö†Ô∏è Demo data ‚Äì ƒçek√°me na Nayax API p≈ô√≠stup</div>

    <!-- P≈òEHLED -->
    <div class="sec-hdr"><span class="sec-title">P≈ôehled</span><div class="sec-line"></div></div>

    <div class="stats-row">
      <div class="sc sc-blue"><div class="st"><div class="sl">Tr≈æby celkem</div><span class="badge bu" id="b1">‚Äì</span></div><div class="sv" id="v-rev">‚Äì</div><div class="ss" id="s-rev">naƒç√≠t√°m...</div></div>
      <div class="sc sc-green"><div class="st"><div class="sl">Poƒçet prodej≈Ø</div><span class="badge bn" id="b2">‚Äì</span></div><div class="sv" id="v-sales">‚Äì</div><div class="ss" id="s-sales">naƒç√≠t√°m...</div></div>
      <div class="sc sc-warn"><div class="st"><div class="sl">Pr≈Ømƒõrn√° hodnota</div><span class="badge bn">/ n√°kup</span></div><div class="sv" id="v-avg">‚Äì</div><div class="ss">pr≈Ømƒõr na transakci</div></div>
      <div class="sc sc-red"><div class="st"><div class="sl">Nejlep≈°√≠ den</div><span class="badge bs">‚≠ê Top</span></div><div class="sv" id="v-bestday">‚Äì</div><div class="ss" id="s-bestday">naƒç√≠t√°m...</div></div>
    </div>
    <div class="stats-row" style="margin-bottom:1.5rem">
      <div class="sc sc-purple"><div class="st"><div class="sl">Nejvy≈°≈°√≠ n√°kup</div><span class="badge bp">Max</span></div><div class="sv" id="v-max">‚Äì</div><div class="ss">jednor√°zov√° transakce</div></div>
      <div class="sc sc-cyan"><div class="st"><div class="sl">Dne≈°n√≠ tr≈æby</div><span class="badge bn">Dnes</span></div><div class="sv" id="v-today">‚Äì</div><div class="ss" id="s-today">naƒç√≠t√°m...</div></div>
      <div class="sc sc-lime"><div class="st"><div class="sl">Tento t√Ωden</div><span class="badge bn">T√Ωden</span></div><div class="sv" id="v-week">‚Äì</div><div class="ss">od pondƒõl√≠ do dnes</div></div>
      <div class="sc sc-pink"><div class="st"><div class="sl">Hotovost vs Karta</div><span class="badge bn">Split</span></div><div class="sv" id="v-split">‚Äì</div><div class="ss" id="s-split">naƒç√≠t√°m...</div></div>
    </div>

    <!-- GRAF + TRANSAKCE -->
    <div class="sec-hdr"><span class="sec-title">P≈ôehled tr≈æeb</span><div class="sec-line"></div></div>

    <div class="gm">
      <div class="card">
        <div class="ch"><div><div class="ct">Tr≈æby po dnech</div><div class="cs">Celkov√© denn√≠ tr≈æby v Kƒç</div></div></div>
        <div style="position:relative;height:220px"><canvas id="cRev"></canvas></div>
      </div>
      <div class="card">
        <div class="ch"><div><div class="ct">Posledn√≠ transakce</div><div class="cs">Nejnovƒõj≈°√≠ prodeje</div></div></div>
        <div id="txList"><div class="empty">Naƒç√≠t√°m...</div></div>
      </div>
    </div>

  </div>
</div>
</div>

<script>
if(sessionStorage.getItem('auth')!=='ok')window.location.href='index.html';
function logout(){sessionStorage.removeItem('auth');window.location.href='index.html';}

const SLOTS={};
const DC=['Ne','Po','√öt','St','ƒåt','P√°','So'];
const GOAL=1000;
let AD=30,cRev;

const fmt=v=>Math.round(v).toLocaleString('cs-CZ')+' Kƒç';
const fmts=v=>v>=1000?(v/1000).toFixed(1)+'k':Math.round(v);
const gd=t=>new Date(t.AuthorizationDateTimeGMT||t.SaleDate||t.Date||t.TransactionDate||0);
const ga=t=>parseFloat(t.SettlementValue||t.AuthorizationValue||t.Amount||t.amount||t.Price||0);
const gs=t=>t.Selection||t.SlotNumber||t.slotNumber||t.ProductId||'?';
const sn=n=>SLOTS[String(n)]||`Slot ${n}`;
function pm(t){const m=(t.PaymentMethod||t.CardBrand||t.paymentType||'').toLowerCase();if(m.includes('cash'))return'Hotovost';if(m.includes('visa'))return'Visa';if(m.includes('master'))return'Mastercard';if(m.includes('apple'))return'Apple Pay';if(m.includes('google'))return'Google Pay';return'Karta';}
function dc(m){if(m==='Hotovost')return'dw';if(m.includes('Pay'))return'db';return'dg';}

function processData(sales,days){
  const now=new Date(),cut=new Date();cut.setDate(cut.getDate()-days);
  const sow=new Date(now);sow.setDate(now.getDate()-now.getDay()+1);sow.setHours(0,0,0,0);
  const tod=new Date();tod.setHours(0,0,0,0);
  const f=sales.filter(s=>gd(s)>=cut);
  const byDay={};const byWD=Array(7).fill(0);
  let todR=0,todS=0,wkR=0,maxT=0,cashR=0,cardR=0;
  f.forEach(s=>{
    const d=gd(s),a=ga(s),wd=d.getDay(),m=pm(s);
    const key=d.toLocaleDateString('cs-CZ',{day:'2-digit',month:'2-digit'});
    byDay[key]=(byDay[key]||0)+a;
    byWD[wd]+=a;
    if(d>=sow)wkR+=a;
    if(d>=tod){todR+=a;todS++;}
    if(a>maxT)maxT=a;
    if(m==='Hotovost')cashR+=a;else cardR+=a;
  });
  const tr=f.reduce((s,t)=>s+ga(t),0),ts=f.length,av=ts?tr/ts:0;
  const bi=byWD.indexOf(Math.max(...byWD));
  const lastTx=[...f].sort((a,b)=>gd(b)-gd(a)).slice(0,12).map(s=>{const m=pm(s);return{time:gd(s).toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit'}),product:sn(gs(s)),method:m,amount:ga(s),dot:dc(m)};});
  return{byDay,tr,ts,av,bi,bdr:byWD[bi],todR,todS,wkR,maxT,cashR,cardR,lastTx};
}

function generateMockData(){
  const products=[{slot:'8',name:'Booster Pack SV',price:170},{slot:'10',name:'Tin Box',price:300},{slot:'13',name:'Pikachu Promo',price:60},{slot:'18',name:'Charizard ETB',price:400},{slot:'24',name:'Booster Pack XY',price:150},{slot:'3',name:'Blister Pack',price:120},{slot:'5',name:'Mini Tin',price:85}];
  const methods=['Karta','Karta','Karta','Visa','Mastercard','Hotovost','Apple Pay','Google Pay'];
  const sales=[];const now=new Date();
  for(let day=89;day>=0;day--){
    const d=new Date(now);d.setDate(d.getDate()-day);
    const isWE=d.getDay()===0||d.getDay()===6;
    const count=isWE?Math.floor(Math.random()*8)+12:Math.floor(Math.random()*6)+7;
    for(let i=0;i<count;i++){
      const hour=Math.random()<0.7?Math.floor(Math.random()*9)+10:Math.floor(Math.random()*24);
      const dt=new Date(d);dt.setHours(hour,Math.floor(Math.random()*60),0,0);
      const weights=[3,2,4,1,3,2,2];const rand=Math.random()*17;let wi=0,ws=0;
      for(let j=0;j<weights.length;j++){ws+=weights[j];if(rand<ws){wi=j;break;}}
      const prod=products[wi];
      sales.push({AuthorizationDateTimeGMT:dt.toISOString(),SettlementValue:prod.price,Selection:prod.slot,PaymentMethod:methods[Math.floor(Math.random()*methods.length)]});
    }
  }
  return sales;
}

Chart.defaults.color='#5a5a6a';Chart.defaults.font.family="'DM Sans',sans-serif";Chart.defaults.font.size=10.5;
const TT={backgroundColor:'#18181d',borderColor:'rgba(255,255,255,0.07)',borderWidth:1,titleColor:'#e8e8ec',bodyColor:'#8888a0',padding:10};

function renderAll(sales){
  const d=processData(sales,AD);
  // Stats
  document.getElementById('v-rev').textContent=fmt(d.tr);
  document.getElementById('b1').textContent=`${d.ts} prod.`;
  document.getElementById('s-rev').innerHTML=`za posledn√≠ch <strong>${AD} dn√≠</strong>`;
  document.getElementById('v-sales').textContent=d.ts;
  document.getElementById('b2').textContent=`~${(d.ts/AD).toFixed(1)}/den`;
  document.getElementById('s-sales').innerHTML=`pr≈Ømƒõrnƒõ <strong>${(d.ts/AD).toFixed(1)} prodej≈Ø/den</strong>`;
  document.getElementById('v-avg').textContent=fmt(d.av);
  document.getElementById('v-bestday').textContent=DC[d.bi];
  document.getElementById('s-bestday').innerHTML=`pr≈Ømƒõrn√© tr≈æby <strong>${fmt(d.bdr)}</strong>`;
  document.getElementById('v-max').textContent=fmt(d.maxT);
  document.getElementById('v-today').textContent=fmt(d.todR);
  document.getElementById('s-today').innerHTML=`<strong>${d.todS} prodej≈Ø</strong> dnes`;
  document.getElementById('v-week').textContent=fmt(d.wkR);
  const cp=d.tr?Math.round(d.cashR/d.tr*100):0;
  document.getElementById('v-split').textContent=`${cp}% / ${100-cp}%`;
  document.getElementById('s-split').innerHTML=`hotovost <strong>${fmt(d.cashR)}</strong> ¬∑ karta <strong>${fmt(d.cardR)}</strong>`;
  // Revenue chart
  if(cRev)cRev.destroy();
  const ctx=document.getElementById('cRev');
  const g=ctx.getContext('2d').createLinearGradient(0,0,0,220);
  g.addColorStop(0,'rgba(79,142,247,.18)');g.addColorStop(1,'rgba(79,142,247,0)');
  cRev=new Chart(ctx,{type:'line',data:{labels:Object.keys(d.byDay),datasets:[{data:Object.values(d.byDay),borderColor:'#4f8ef7',backgroundColor:g,borderWidth:2,pointRadius:0,pointHoverRadius:4,tension:.4,fill:true}]},options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false},tooltip:{...TT,callbacks:{label:c=>`  ${Math.round(c.parsed.y).toLocaleString('cs-CZ')} Kƒç`}}},scales:{x:{grid:{color:'rgba(255,255,255,.03)'},ticks:{maxTicksLimit:10}},y:{grid:{color:'rgba(255,255,255,.03)'},ticks:{callback:v=>fmts(v)+' Kƒç'}}}}});
  // Transactions
  document.getElementById('txList').innerHTML=d.lastTx.length
    ?d.lastTx.map(t=>`<div class="tx-row"><div class="tx-dot ${t.dot}"></div><div class="tt">${t.time}</div><div class="tp">${t.product}</div><div class="tm">${t.method}</div><div class="ta">${fmt(t.amount)}</div></div>`).join('')
    :'<div class="empty">≈Ω√°dn√© transakce</div>';
  // Save to sessionStorage for grafy.html
  sessionStorage.setItem('salesData',JSON.stringify(sales));
}

async function loadData(){
  document.getElementById('loading').style.display='flex';
  try{
    const res=await fetch('/api/sales');
    if(!res.ok)throw new Error(`${res.status}`);
    const raw=await res.json();
    const sales=Array.isArray(raw)?raw:(raw.Sales||raw.sales||raw.Data||raw.data||[]);
    renderAll(sales);
    document.getElementById('demoBadge').style.display='none';
    document.getElementById('apiDot').classList.remove('red');
    document.getElementById('apiStatus').textContent='Nayax ¬∑ online';
    document.getElementById('lastUpdate').textContent=new Date().toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit'});
  }catch(e){
    const mock=generateMockData();
    renderAll(mock);
    document.getElementById('demoBadge').style.display='inline-flex';
    document.getElementById('apiDot').classList.add('red');
    document.getElementById('apiStatus').textContent='Demo data';
    document.getElementById('lastUpdate').textContent=new Date().toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit'})+' ¬∑ demo';
  }finally{document.getElementById('loading').style.display='none';}
}

function setPeriod(btn,days){document.querySelectorAll('.ptab').forEach(b=>b.classList.remove('active'));btn.classList.add('active');AD=days;loadData();}
setInterval(loadData,5*60*1000);
loadData();
</script>
</body>
</html>
